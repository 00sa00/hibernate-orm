<?xml version="1.0" encoding="UTF-8"?>
<testsuite errors="0" failures="0" hostname="dhcp-10.15.208.168.stl.redhat.com" name="org.hibernate.test.annotations.tableperclass.TablePerClassTest" tests="2" time="0.125" timestamp="2013-02-28T20:10:44">
  <properties />
  <testcase classname="org.hibernate.test.annotations.tableperclass.TablePerClassTest" name="testConstraintsOnSuperclassProperties" time="0.036" />
  <testcase classname="org.hibernate.test.annotations.tableperclass.TablePerClassTest" name="testUnionSubClass" time="0.042" />
  <system-out><![CDATA[14:10:44,505  INFO CustomRunner:132 - BeforeClass: org.hibernate.test.annotations.tableperclass.TablePerClassTest
14:10:44,510  INFO DriverManagerConnectionProviderImpl:99 - HHH000402: Using Hibernate built-in connection pool (not for production use!)
14:10:44,511  INFO DriverManagerConnectionProviderImpl:135 - HHH000115: Hibernate connection pool size: 5
14:10:44,511  INFO DriverManagerConnectionProviderImpl:138 - HHH000006: Autocommit mode: false
14:10:44,511  INFO DriverManagerConnectionProviderImpl:153 - HHH000401: using driver [org.h2.Driver] at URL [jdbc:h2:mem:db1;DB_CLOSE_DELAY=-1;MVCC=TRUE]
14:10:44,511  INFO DriverManagerConnectionProviderImpl:158 - HHH000046: Connection properties: {user=sa}
14:10:44,512  INFO Dialect:103 - HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
14:10:44,512  INFO LobCreatorBuilder:94 - HHH000423: Disabling contextual LOB creation as JDBC driver reported JDBC version [3] less than 4
14:10:44,513  INFO TransactionFactoryInitiator:66 - HHH000399: Using default transaction strategy (direct JDBC transactions)
14:10:44,513  INFO ASTQueryTranslatorFactory:48 - HHH000397: Using ASTQueryTranslatorFactory
14:10:44,513  WARN CachingRegionFactory:58 - CachingRegionFactory should be only used for testing.
14:10:44,517  INFO TableGenerator:414 - HHH000398: Explicit segment value for id generator [hibernate_sequences.sequence_name] suggested; using default [default]
14:10:44,527  INFO TableGenerator:414 - HHH000398: Explicit segment value for id generator [hibernate_sequences.sequence_name] suggested; using default [default]
14:10:44,528  INFO TableGenerator:414 - HHH000398: Explicit segment value for id generator [hibernate_sequences.sequence_name] suggested; using default [default]
14:10:44,528  INFO SchemaExport:343 - HHH000227: Running hbm2ddl schema export
14:10:44,528 DEBUG SchemaExport:353 - Import file not found: /import.sql
14:10:44,528 DEBUG SQL:104 - 
    drop table Machine if exists
14:10:44,529 DEBUG SQL:104 - 
    drop table Robot if exists
14:10:44,529 DEBUG SQL:104 - 
    drop table T800 if exists
14:10:44,529 DEBUG SQL:104 - 
    drop table xPM_Product if exists
14:10:44,529 DEBUG SQL:104 - 
    drop table hibernate_sequences if exists
14:10:44,529 DEBUG SQL:104 - 
    create table Machine (
        id integer not null,
        weight double,
        primary key (id)
    )
14:10:44,529 DEBUG SQL:104 - 
    create table Robot (
        id integer not null,
        weight double,
        name varchar(255),
        primary key (id)
    )
14:10:44,530 DEBUG SQL:104 - 
    create table T800 (
        id integer not null,
        weight double,
        name varchar(255),
        targetName varchar(255),
        primary key (id)
    )
14:10:44,530 DEBUG SQL:104 - 
    create table xPM_Product (
        id bigint not null,
        manufacturerId bigint not null,
        manufacturerPartNumber varchar(255) not null,
        primary key (id)
    )
14:10:44,530 DEBUG SQL:104 - 
    alter table xPM_Product 
        add constraint UK_xPM_Product_1 unique (manufacturerPartNumber, manufacturerId)
14:10:44,530 DEBUG SQL:104 - 
    create index xPM_ProductmanufacturerPartNumber on xPM_Product (manufacturerPartNumber)
14:10:44,531 DEBUG SQL:104 - 
    create table hibernate_sequences (
         sequence_name varchar(255) not null ,
         next_val bigint,
        primary key ( sequence_name ) 
    ) 
14:10:44,531  INFO SchemaExport:405 - HHH000230: Schema export complete
14:10:44,531  INFO TableGenerator:414 - HHH000398: Explicit segment value for id generator [hibernate_sequences.sequence_name] suggested; using default [default]
14:10:44,531  INFO TableGenerator:414 - HHH000398: Explicit segment value for id generator [hibernate_sequences.sequence_name] suggested; using default [default]
14:10:44,532  WARN SessionFactoryImpl:1554 - HHH000008: JTASessionContext being used with JDBCTransactionFactory; auto-flush will not operate correctly with getCurrentSession()
14:10:44,532  INFO CustomRunner:139 - Test: testConstraintsOnSuperclassProperties
14:10:44,565 DEBUG SQL:104 - 
    insert 
    into
        xPM_Product
        (manufacturerId, manufacturerPartNumber, id) 
    values
        (?, ?, ?)
14:10:44,566 DEBUG SQL:104 - 
    insert 
    into
        xPM_Product
        (manufacturerId, manufacturerPartNumber, id) 
    values
        (?, ?, ?)
14:10:44,566  WARN SqlExceptionHelper:143 - SQL Error: 23001, SQLState: 23001
14:10:44,566 ERROR SqlExceptionHelper:144 - Unique index or primary key violation: "UK_XPM_PRODUCT_1_INDEX_C ON PUBLIC.XPM_PRODUCT(MANUFACTURERPARTNUMBER, MANUFACTURERID)"; SQL statement:
insert into xPM_Product (manufacturerId, manufacturerPartNumber, id) values (?, ?, ?) [23001-145]
14:10:44,566  INFO AbstractBatchImpl:195 - HHH000010: On release of batch it still contained JDBC statements
14:10:44,568  INFO CustomRunner:139 - Test: testUnionSubClass
14:10:44,571 DEBUG SQL:104 - 
    select
        tbl.next_val 
    from
        hibernate_sequences tbl 
    where
        tbl.sequence_name=? for update
            
14:10:44,572 DEBUG SQL:104 - 
    insert 
    into
        hibernate_sequences
        (sequence_name, next_val)  
    values
        (?,?)
14:10:44,572 DEBUG SQL:104 - 
    update
        hibernate_sequences 
    set
        next_val=?  
    where
        next_val=? 
        and sequence_name=?
14:10:44,572 DEBUG SQL:104 - 
    select
        tbl.next_val 
    from
        hibernate_sequences tbl 
    where
        tbl.sequence_name=? for update
            
14:10:44,572 DEBUG SQL:104 - 
    update
        hibernate_sequences 
    set
        next_val=?  
    where
        next_val=? 
        and sequence_name=?
14:10:44,573 DEBUG SQL:104 - 
    select
        tbl.next_val 
    from
        hibernate_sequences tbl 
    where
        tbl.sequence_name=? for update
            
14:10:44,573 DEBUG SQL:104 - 
    update
        hibernate_sequences 
    set
        next_val=?  
    where
        next_val=? 
        and sequence_name=?
14:10:44,575 DEBUG SQL:104 - 
    insert 
    into
        Machine
        (weight, id) 
    values
        (?, ?)
14:10:44,576 DEBUG SQL:104 - 
    insert 
    into
        Robot
        (weight, name, id) 
    values
        (?, ?, ?)
14:10:44,576 DEBUG SQL:104 - 
    insert 
    into
        T800
        (weight, name, targetName, id) 
    values
        (?, ?, ?, ?)
14:10:44,577 DEBUG QueryTranslatorImpl:265 - parse() - HQL: from org.hibernate.test.annotations.tableperclass.Machine m where m.weight >= :weight
14:10:44,578 DEBUG QueryTranslatorImpl:283 - --- HQL AST ---
 \-[QUERY] Node: 'query'
    +-[SELECT_FROM] Node: 'SELECT_FROM'
    |  \-[FROM] Node: 'from'
    |     \-[RANGE] Node: 'RANGE'
    |        +-[DOT] Node: '.'
    |        |  +-[DOT] Node: '.'
    |        |  |  +-[DOT] Node: '.'
    |        |  |  |  +-[DOT] Node: '.'
    |        |  |  |  |  +-[DOT] Node: '.'
    |        |  |  |  |  |  +-[IDENT] Node: 'org'
    |        |  |  |  |  |  \-[IDENT] Node: 'hibernate'
    |        |  |  |  |  \-[IDENT] Node: 'test'
    |        |  |  |  \-[IDENT] Node: 'annotations'
    |        |  |  \-[IDENT] Node: 'tableperclass'
    |        |  \-[IDENT] Node: 'Machine'
    |        \-[ALIAS] Node: 'm'
    \-[WHERE] Node: 'where'
       \-[GE] Node: '>='
          +-[DOT] Node: '.'
          |  +-[IDENT] Node: 'm'
          |  \-[IDENT] Node: 'weight'
          \-[COLON] Node: ':'
             \-[IDENT] Node: 'weight'

14:10:44,578 DEBUG ErrorCounter:82 - throwQueryException() : no errors
14:10:44,578 DEBUG FromElement:157 - FromClause{level=1} : org.hibernate.test.annotations.tableperclass.Machine (m) -> machine0_
14:10:44,578 DEBUG FromReferenceNode:74 - Resolved : m -> machine0_.id
14:10:44,578 DEBUG DotNode:599 - getDataType() : weight -> org.hibernate.type.DoubleType@26e7f2ac
14:10:44,579 DEBUG FromReferenceNode:74 - Resolved : m.weight -> machine0_.weight
14:10:44,579 DEBUG HqlSqlWalker:629 - processQuery() :  ( SELECT ( FromClause{level=1} ( select id, weight, null as name, null as targetName, 0 as clazz_ from Machine union all select id, weight, name, targetName, 2 as clazz_ from T800 union all select id, weight, name, null as targetName, 1 as clazz_ from Robot ) machine0_ ) ( where ( >= ( machine0_.weight machine0_.id weight ) ? ) ) )
14:10:44,579 DEBUG HqlSqlWalker:869 - Derived SELECT clause created.
14:10:44,579 DEBUG JoinProcessor:175 - Using FROM fragment [( select id, weight, null as name, null as targetName, 0 as clazz_ from Machine union all select id, weight, name, targetName, 2 as clazz_ from T800 union all select id, weight, name, null as targetName, 1 as clazz_ from Robot ) machine0_]
14:10:44,579 DEBUG QueryTranslatorImpl:252 - --- SQL AST ---
 \-[SELECT] QueryNode: 'SELECT'  querySpaces (Robot,Machine,T800)
    +-[SELECT_CLAUSE] SelectClause: '{derived select clause}'
    |  +-[SELECT_EXPR] SelectExpressionImpl: 'machine0_.id as id0_' {FromElement{explicit,not a collection join,not a fetch join,fetch non-lazy properties,classAlias=m,role=null,tableName=( select id, weight, null as name, null as targetName, 0 as clazz_ from Machine union all select id, weight, name, targetName, 2 as clazz_ from T800 union all select id, weight, name, null as targetName, 1 as clazz_ from Robot ),tableAlias=machine0_,origin=null,columns={,className=org.hibernate.test.annotations.tableperclass.Machine}}}
    |  \-[SQL_TOKEN] SqlFragment: 'machine0_.weight as weight0_, machine0_.name as name1_, machine0_.targetName as targetName2_, machine0_.clazz_ as clazz_'
    +-[FROM] FromClause: 'from' FromClause{level=1, fromElementCounter=1, fromElements=1, fromElementByClassAlias=[m], fromElementByTableAlias=[machine0_], fromElementsByPath=[], collectionJoinFromElementsByPath=[], impliedElements=[]}
    |  \-[FROM_FRAGMENT] FromElement: '( select id, weight, null as name, null as targetName, 0 as clazz_ from Machine union all select id, weight, name, targetName, 2 as clazz_ from T800 union all select id, weight, name, null as targetName, 1 as clazz_ from Robot ) machine0_' FromElement{explicit,not a collection join,not a fetch join,fetch non-lazy properties,classAlias=m,role=null,tableName=( select id, weight, null as name, null as targetName, 0 as clazz_ from Machine union all select id, weight, name, targetName, 2 as clazz_ from T800 union all select id, weight, name, null as targetName, 1 as clazz_ from Robot ),tableAlias=machine0_,origin=null,columns={,className=org.hibernate.test.annotations.tableperclass.Machine}}
    \-[WHERE] SqlNode: 'where'
       \-[GE] BinaryLogicOperatorNode: '>='
          +-[DOT] DotNode: 'machine0_.weight' {propertyName=weight,dereferenceType=ALL,propertyPath=weight,path=m.weight,tableAlias=machine0_,className=org.hibernate.test.annotations.tableperclass.Machine,classAlias=m}
          |  +-[ALIAS_REF] IdentNode: 'machine0_.id' {alias=m, className=org.hibernate.test.annotations.tableperclass.Machine, tableAlias=machine0_}
          |  \-[IDENT] IdentNode: 'weight' {originalText=weight}
          \-[NAMED_PARAM] ParameterNode: '?' {name=weight, expectedType=org.hibernate.type.DoubleType@26e7f2ac}

14:10:44,579 DEBUG ErrorCounter:82 - throwQueryException() : no errors
14:10:44,579 DEBUG QueryTranslatorImpl:235 - HQL: from org.hibernate.test.annotations.tableperclass.Machine m where m.weight >= :weight
14:10:44,580 DEBUG QueryTranslatorImpl:236 - SQL: select machine0_.id as id0_, machine0_.weight as weight0_, machine0_.name as name1_, machine0_.targetName as targetName2_, machine0_.clazz_ as clazz_ from ( select id, weight, null as name, null as targetName, 0 as clazz_ from Machine union all select id, weight, name, targetName, 2 as clazz_ from T800 union all select id, weight, name, null as targetName, 1 as clazz_ from Robot ) machine0_ where machine0_.weight>=?
14:10:44,580 DEBUG ErrorCounter:82 - throwQueryException() : no errors
14:10:44,580 DEBUG SQL:104 - 
    select
        machine0_.id as id0_,
        machine0_.weight as weight0_,
        machine0_.name as name1_,
        machine0_.targetName as targetName2_,
        machine0_.clazz_ as clazz_ 
    from
        ( select
            id,
            weight,
            null as name,
            null as targetName,
            0 as clazz_ 
        from
            Machine 
        union
        all select
            id,
            weight,
            name,
            targetName,
            2 as clazz_ 
        from
            T800 
        union
        all select
            id,
            weight,
            name,
            null as targetName,
            1 as clazz_ 
        from
            Robot 
    ) machine0_ 
where
    machine0_.weight>=?
14:10:44,611  INFO SchemaExport:343 - HHH000227: Running hbm2ddl schema export
14:10:44,627 DEBUG SchemaExport:353 - Import file not found: /import.sql
14:10:44,627 DEBUG SQL:104 - 
    drop table Machine if exists
14:10:44,628 DEBUG SQL:104 - 
    drop table Robot if exists
14:10:44,628 DEBUG SQL:104 - 
    drop table T800 if exists
14:10:44,628 DEBUG SQL:104 - 
    drop table xPM_Product if exists
14:10:44,629 DEBUG SQL:104 - 
    drop table hibernate_sequences if exists
14:10:44,629  INFO SchemaExport:405 - HHH000230: Schema export complete
14:10:44,629  INFO DriverManagerConnectionProviderImpl:162 - HHH000030: Cleaning up connection pool [jdbc:h2:mem:db1;DB_CLOSE_DELAY=-1;MVCC=TRUE]
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>
